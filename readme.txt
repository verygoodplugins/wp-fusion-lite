=== WP Fusion Lite - Marketing Automation and CRM Integration for WordPress ===
Contributors: verygoodplugins
Tags: crm, marketing automation, sync, integration, membership
Requires at least: 4.6
Requires PHP: 5.6
Tested up to: 6.5.0
Stable tag: 3.43.0

WP Fusion Lite synchronizes your WordPress users with contact records in your CRM or marketing automation system.

== Description ==

WP Fusion Lite synchronizes your WordPress users with leading CRMs and marketing automation systems, keeps user profiles in sync with CRM contact records, and lets you protect site content based on CRM tags.

= Features =

* Automatically [create new contacts in your CRM](https://wpfusion.com/documentation/getting-started/general-settings/?utm_campaign=free-plugin&utm_source=wp-org#automatically-create-contact-records-for-new-users) when users register in WordPress
* [Restrict access to site content](https://wpfusion.com/documentation/getting-started/access-control/?utm_campaign=free-plugin&utm_source=wp-org) using tags and lists in your CRM
* [Synchronize any WordPress user data]((https://wpfusion.com/documentation/getting-started/syncing-contact-fields/?utm_campaign=free-plugin&utm_source=wp-org)) with custom fields in your CRM
* [Apply tags when users register](https://wpfusion.com/documentation/getting-started/general-settings/?utm_campaign=free-plugin&utm_source=wp-org#assign-tags)
* [Import contacts from your CRM](https://wpfusion.com/documentation/tutorials/import-users/?utm_campaign=free-plugin&utm_source=wp-org) as new WordPress users and generate passwords for them
* [Export WordPress users](https://wpfusion.com/documentation/tutorials/batch-operations/?utm_campaign=free-plugin&utm_source=wp-org) to your CRM as contact records
* [Track visitor activity](https://wpfusion.com/documentation/tutorials/site-tracking-scripts/?utm_campaign=free-plugin&utm_source=wp-org) using your CRM's tracking scripts (with supported CRMs)

> WP Fusion is a critical tool in our toolkit for our clients, and we VERY strongly encourage our clients to use WP Fusion if they have any kind of CRM. The software is top notch, and the support team is fast and friendly. Nothing but love for WP Fusion from my team here at House Trevethan.

> Allen Trevethan - House Trevethan

= Lite Version =

This is a free version of [WP Fusion](https://wpfusion.com/?utm_campaign=free-plugin&utm_source=wp-org). WP Fusion Lite synchronizes your **registered WordPress users** with your connected CRM, including their name and email address.

It does not apply tags based on purchases or course activity, sync form entries, sync customers, or detect any data generated by other plugins.

For integration with WooCommerce, LearnDash, Gravity Forms, Elementor and [over 100 other popular WordPress plugins](https://wpfusion.com/documentation/integrations/?utm_campaign=free-plugin&utm_source=wp-org), check out [one of our paid licenses](https://wpfusion.com/pricing/?utm_campaign=free-plugin&utm_source=wp-org).

[youtube https://www.youtube.com/watch?v=wzRajxCUxNI] 

= Benefits =

* ‚ö° Replace Zapier, Integromat, and other integration tools. WP Fusion gives you a direct data sync between your site and your CRM, with no delays or limits.

* üîí Create easy to manage membership sites with drip-released content using timers and logic in your CRM.

* üíé Personalize your site by displaying data from CRM contact records, and showing / hiding content based on a user's CRM tags or lists.

> WP Fusion allows us to provide tailored customer experiences in WordPress that wow every time.

> Hundreds of plugins that used to be one size fits all, can now perform differently for each Ontraport contact. For example, a low scoring Ontraport contact can be presented with a winback customer journey in WordPress.

> This has allowed our clients to increase customer engagement and retention. It's the only solution that should be considered for any WordPress integration.

> Josh Schleifer - Triple Canopy

= Docs and Tutorials =

 * üì¶ [Installation Guide](https://wpfusion.com/documentation/getting-started/installation-guide/?utm_campaign=free-plugin&utm_source=wp-org)
 * üîí [Controlling access to content with CRM tags](https://wpfusion.com/documentation/getting-started/access-control/?utm_campaign=free-plugin&utm_source=wp-org)
 * üìù [Shortcodes](https://wpfusion.com/documentation/getting-started/shortcodes/?utm_campaign=free-plugin&utm_source=wp-org)
 * üëÄ [Displaying CRM data in WordPress](https://wpfusion.com/documentation/tutorials/displaying-crm-data-in-wordpress/?utm_campaign=free-plugin&utm_source=wp-org)
 * üî• [Sync WordPress users with CRM contact records](https://wpfusion.com/documentation/getting-started/syncing-contact-fields/?utm_campaign=free-plugin&utm_source=wp-org)
 * üîë [Import users from your CRM and generate passwords](https://wpfusion.com/documentation/tutorials/import-users/?utm_campaign=free-plugin&utm_source=wp-org)
 * üì§ [Export users and metadata to your CRM](https://wpfusion.com/documentation/tutorials/batch-operations/?utm_campaign=free-plugin&utm_source=wp-org)
 * üìà [Sync Google Analytics and other leadsource variables with your CRM](https://wpfusion.com/documentation/tutorials/lead-source-tracking/?utm_campaign=free-plugin&utm_source=wp-org)
 * üè∑Ô∏è [Track user activity using tags](https://wpfusion.com/documentation/getting-started/tracking-user-activity/?utm_campaign=free-plugin&utm_source=wp-org)
 * üîÆ [Auto login links](https://wpfusion.com/documentation/tutorials/auto-login-links/?utm_campaign=free-plugin&utm_source=wp-org)

> WP Fusion builds a critical bridge between our WooCommerce powered ecommerce site and LifterLMS powered training site to our CRM ActiveCampaign. It was easy to set up. The technical support is above and beyond anything I've ever seen. What it does is clearly intelligently designed and well built.

> Chris Badgett - LifterLMS

= Supported CRMs and marketing automation platforms =

* ActiveCampaign
* AgileCRM
* Autopilot
* Autonami
* Bento
* BirdSend
* Capsule
* Constant Contact
* ConvertKit
* Copper
* Customerly
* Customer.io
* Drift
* Drip
* EmailOctopus
* Engage
* EngageBay
* Flexie
* FluentCRM (same site or REST API)
* GetResponse
* Gist
* Groundhogg (same site or REST API)
* Growmatik
* HighLevel
* HubSpot
* Infusionsoft
* Intercom
* Jetpack CRM
* Kartra
* Klaviyo
* Klick-Tipp
* Loopify
* MailChimp
* MailEngine
* MailerLite
* Mailjet
* MailPoet
* Maropost
* Mautic
* Microsoft Dynamics 365
* MooSend
* NationBuilder
* Omnisend
* Ontraport
* Ortto
* Pipedrive
* Platform.ly
* PulseTechnologyCRM
* Quentn
* Salesflare
* Salesforce
* SendFox
* SendinBlue
* Sendlane
* Tubular
* UserEngage
* WP ERP
* Zoho

For more info on CRM compatibility, [check out the compatibility table](https://wpfusion.com/documentation/faq/crm-compatibility-table/?utm_campaign=free-plugin&utm_source=wp-org).

> WP Fusion is one of my secret weapons for getting WordPress to keep our member's data synced with our CRM. This makes everything work so much better when you don't have to worry about your members having issues logging into the member's area.

> If you have or are considering having a membership website using WordPress this plugin is a must-have. It will save you hours of time and frustration.

> Greg Russell - SuccessTeam Marketing

== Screenshots ==

1. Sync any WordPress user fields with contact records in your CRM
2. View and manage contact tags within WordPress
3. Restrict access to content based on a contact's tags
4. Use the Gutenberg block to show and hide content within a page based on a contact's CRM tags

== Installation ==

Upload and activate the plugin, then go to Settings >> WP Fusion. Select your desired CRM, enter your API credentials and click "Connect" to verify the connection.

For CRM-specific setup information, see our [Installation Guide](https://wpfusion.com/documentation/getting-started/installation-guide/?utm_campaign=free-plugin&utm_source=wp-org).

== Frequently Asked Questions ==

= Who is it for? =

WP Fusion is built for anyone using a [CRM or marketing automation platform](https://wpfusion.com/documentation/faq/crm-compatibility-table/?utm_campaign=free-plugin&utm_source=wp-org), and running their website with WordPress.

CRMs empower businesses to track leads, send email broadcasts, manage contact data, track sales, delegate client relationships between employees, and more.

WordPress handles the public facing side of your business: your sales pages, ecommerce platform, support forums, photos and videos, and anything else you want the world to see.

**But your CRM and WordPress don‚Äôt talk to each other.**

**This is where WP Fusion comes in.**

WP Fusion acts as a bridge between your WordPress data and CRM data‚Äî it allows you to use data from WordPress to power your marketing campaigns, and data from your CRM to personalize the customer experience in WordPress.

= How is it different from Zapier? =

While WP Fusion and Zapier are both integration tools, they work quite differently.

Zapier is a SaaS (Software as a Service) solution that acts as a middleman between your site and your CRM (as well as many other platforms).

When something is updated in WordPress, it is synced to Zapier‚Äôs website, and then Zapier syncs the data on to your desired platform. Depending on your plan there is a delay before the data is synced, and/or limit on how many ‚Äútasks‚Äù you can run each month.

**WP Fusion connects your site directly to your CRM or marketing automation platform** over the API (nothing goes through our website). Because of this the sync of data is instant, secure, and there are no monthly limits.

In addition to syncing data with your CRM, WP Fusion also includes many options for [protecting your WordPress content based on CRM tags](https://wpfusion.com/documentation/getting-started/access-control/?utm_campaign=free-plugin&utm_source=wp-org), and triggering changes in membership level or course enrollments based on CRM automations. This generally isn‚Äôt possible with Zapier because Zapier is configured via zapier.com, not inside your WordPress dashboard.

= Why are your version numbers so funny? =

WP Fusion Lite is a copy of the Pro WP Fusion plugin, with support for third-party plugins removed. Each time we release a Lite update, it brings it up to date with the latest version of the Pro plugin. For the full details [see the changelog on our site](https://wpfusion.com/documentation/faq/changelog/?utm_campaign=free-plugin&utm_source=wp-org).

= Can I disable the upgrade nags? =

WP Fusion Lite has a few banners on the settings pages with additional info about the features available in the Pro version.

If you'd prefer not to see these you can disable them with the filter:

`add_filter( 'wp_fusion_hide_upgrade_nags', '__return_true' );`

= How can I report security bugs? =

You can report security bugs through the Patchstack Vulnerability Disclosure Program. The Patchstack team help validate, triage and handle any security vulnerabilities. [Report a security vulnerability.](https://patchstack.com/database/vdp/wp-fusion-lite)

= Do you have more FAQs? = 

Of course, see our [Frequently Asked Questions](https://wpfusion.com/documentation/).

== Changelog ==

= 3.43.0 - 3/18/2024 =

##### New Features

* The Great Date Update
* Added an option with Klaviyo to subscribe contacts to lists with marketing consent
* Added support for the Canadian data center with Zoho
* Added support for loading and displaying read-only fields with HubSpot


##### Improvements

* Improved Zoho integration
* Errors during the initial OAuth connection with Dynamics 365 will now be displayed as a banner on the setup screen
* Updated expired Microsoft Dynamics 365 app secret
* With Klaviyo, the country code will now be prepended to phone numbers if it's missing during a WooCommerce checkout or profile update
* Improved WP Fusion's admin settings and performance


##### Bug Fixes

* Fixed deprecated utf8_encode() warnings in the Infusionsoft/Keap XMLRPC library
* Fixed fatal error Unsupported operand types: null + array with syncing lead source data without any other contact data present since 3.42.10
* Fixed for HighLevel API update of Feb 8th (now sending 403 status codes when access tokens expire, was previously 401)
* Fixed filters added on wpf_format_field_value before init being un-hooked with Zoho
* Fixed error Timestamp must be of type int when syncing string timestamps with Groundhogg (same site)
* Fixed notice not being logged when an update webhook was received but no matching user was found
* Fixed missing nonce check on search log users AJAX handler


##### Developer

* updated the Klaviyo API version to 2023-12-15
* added function wpf_phone_number_to_e164() to convert phone numbers to E.164 format
* If a user has a contact ID and no tags, the tags meta will now be deleted from the usermeta table for that user (reduces database size for users with no tags)


= 3.42.10 - 2/5/2024 =

##### Tech Stuff

* Tested for WordPress 6.5.0


##### New CRMS

* Added a CRM integration with [Customer.io](https://wpfusion.com/documentation/installation-guides/how-to-connect-customer-io-to-wordpress/)
* Added a CRM integation with [Omnisend](https://wpfusion.com/documentation/installation-guides/how-to-connect-omnisend-to-wordpress/)


##### New Features

* Added multi-select option instead of static lists to HubSpot Integration
* Added Source, Time Zone, and Company Name fields for sync with HighLevel
* Added support for syncing optin statuses with Infusionsoft and Keap
* Added WhatsApp field for sync with Brevo
* Added View in CRM links with Klaviyo
* Added support for syncing to date + time fields with FluentCRM (same site and REST API)
* Added support for webhooks in [Mailchimp journeys](https://wpfusion.com/documentation/webhooks/mailchimp-webhooks/#webhooks-in-journeys)
* Added contextual tooltips to some fields in the Contact Fields tab of the WP Fusion settings
* Added an option to apply the current user's CRM tags [as CSS classes to the HTML <body> element](https://wpfusion.com/documentation/getting-started/access-control/#protecting-content-via-css)
* Added support for [using an API key with HighLevel](https://wpfusion.com/documentation/crm-specific-docs/highlevel-white-labelled-accounts/#overview) instead of OAuth
* Added support for [double opt-ins with Brevo](https://wpfusion.com/documentation/tutorials/double-opt-ins/#brevo)
* Added support for [setting a default opt-in status with Groundhogg](https://wpfusion.com/documentation/tutorials/double-opt-ins/#groundhogg) (REST API)
* Added support for saving the field type for each remote field in the CRM. Improves data format conversion (currently just Brevo)
* Added support for lists with FluentCRM (REST API)
* Added support for the [new FluentCRM event tracking module](https://fluentcrm.com/fluentcrm-2-8-40/#dynamic-contact-activity-tracking) (same site and REST API)
* Added [Customer.io site tracking scripts](https://wpfusion.com/documentation/tutorials/site-tracking-scripts/#customer-io)
* Added [Customer.io webhooks](https://wpfusion.com/documentation/webhooks/customer-io-webhooks/)


##### Improvements

* The "Enable API Queue" setting will be hidden when connected to Groundhogg (Same site), as it's unnecessary when not sending API calls
* New custom field created in Groundhogg (same site) will now appear immediately in WP Fusion (no Resync Fields required)
* The HighLevel integration will now also attempt to refresh the access token when it encounters a 401 response
* Improved tags select UI when using the block editor‚Äî now supports typing in new tags, tag groups, refreshing tags via an API call, and creating tags via an API call
* With Brevo, the keys name and id will now show as reserved and can't be used for event tracking
* Improved CRM error logging
* Improved performance when looking up a user ID from a contact ID
* Updated the 'add', 'update', and 'load' contact methods with ActiveCampaign to use the new v3 API (should be faster)
* Fixed missing Reset Deep Data checkbox on the advanced tab (with ActiveCampaign)
* Improved duplicate record error handling for ActiveCampaign and Kaviyo
* You can now use "less" and "greater" instead of < and > in the 'user_meta_if' shortcode attributes
* If a user registers with a missing 'first_name' and 'last_name' but their 'display_name' is set, the Display Name will be used for the first and last names
* If you try to sync multiselect or array-formatted data to a text field in HighLevel, WP Fusion will automatically combine the items to prevent an API error
* If you add 'define( 'WPF_STAGING_MODE', false );' to wp-config.php, this will disable [automatic staging site detection](https://wpfusion.com/documentation/faq/staging-sites/#automatic-staging-site-detection)
* Improved performance with checking permissions on a post based on access rules configured on a taxonomy term
* If staging mode is enabled via wp-config.php ('WPF_STAGING_MODE') the "It looks like this site has moved or is a duplicate" notice will not be displayed
* Extended the timeout with ActiveCampaign to 15 seconds
* Post content restricted by WP Fusion will no longer be accessible over the REST API to unauthorized users
* Fixed a fatal error and custom fields not syncing with Jetpack CRM
* With Brevo, select and multiselect fields will now automatically be synced to their numeric values required by the Brevo API (requires a one-time Refresh Available Tags and Fields via the settings)
* The background worker will now return instead of exit when the queue is empty, to prevent the worker from blocking subsequent cron tasks
* Improved HubSpot error handling
* Updated Omnisend event tracking to use new '/customer-events' endpoint
* Multi-key FluentCRM events will now be sent JSON-encoded
* Improved WP Fusion settings
* The [JavaScript-based lead source tracking method](https://wpfusion.com/documentation/tutorials/lead-source-tracking/#caching) no longer requires jQuery



##### Bug Fixes

* Fixed tags not applying via AJAX for auto-login users since 3.41.22
* Fixed Groundhogg (REST API) and Groundhogg (same site) bugs
* Fixed Email not enabled for sync by default and tagging not working when using the Staging CRM
* Fixed unhandled error when looking up a contact by email address failed during a guest checkout or registration
* Fixed duplicate Phone Number field in HighLevel integration
* Fixed Mailchimp bugs
* Fixed ActiveCampaign bugs and fatal errors
* Fixed FluentCRM (REST API) and FluentCRM (same site) bugs
* Fixed a bug with MailerLite, and HubSpot whereby auto-login links were not being properly detected on the initial page load (only on the second page load)
* Fixed inverted timezone offset for syncing date fields with HubSpot
* Fixed shortcode attributes added to the block editor getting saved with curly quotes
* Fixed PHP errors with Brevo
* Fixed deprecated JavaScript console messages
* Fixed Pipedrive error "Name must be given" when updating a contact and the name field was not present
* Fixed WP Fusion fatal errors and bugs
* Fixed PHP error 'Parse error: syntax error, unexpected ')'' when gathering the user metadata for a user in PHP < 7.3
* Fixed users who registered without a first name getting their first name synced to the CRM as their username
* Fixed 'wpf_get_user_id( $contact_id )' returning the IDs of temporary auto-login users
* Fixed PHP warning 'foreach() argument must be of type array|object, bool given' after deleting all taxonomy-based access rules
* Fixed special characters in tag names breaking If-Menu tag condition dropdowns
* Fixed lead source data for new user registrations being synced even if there was an existing contact in the CRM
* Fixed PHP warnings when no custom fields are available for Omnisend and Drip
* Fixed security vulnerability in the ['user_meta_if' shortcode](https://wpfusion.com/documentation/getting-started/shortcodes/#displaying-content-based-on-user-meta-values), an editor could potentially execute arbitrary PHP code by passing a function name to the 'field_format' parameter


##### Developer

* Added filter 'wpf_hubspot_redirect_uri'
* Deprecated filter 'learndash_settings_fields_wpf' in favor of 'learndash_course_settings_fields_wpf' and 'learndash_quiz_settings_fields_wpf'
* The 'wp_fusion_init' hook has been moved from 'init' priority 0 to priority 6 so that 'wp_fusion()->crm->init()'' has finished
* Removed an 'array_filter()' from the 'WPF_User::get_user_meta()' function (was preventing exporting empty values to the CRM)
* Extended the ActiveCampaign API timeout to 20 seconds for loading, applying and removing tags
* The [wpf_get_user_id filter](https://wpfusion.com/documentation/filters/wpf_get_user_id_filter/) can now return 0, and only runs before the database query



= 3.41.24 - 8/10/2023 =

##### Tech stuff

* Tested for WordPress 6.3.0


##### New CRMs

* Added [EmailOctopus CRM integration](https://wpfusion.com/documentation/installation-guides/how-to-connect-emailoctopus-to-wordpress/)


##### New Features

* Added an `ALL` operator to the [`user_meta_if` shortcode](https://wpfusion.com/documentation/getting-started/shortcodes/#displaying-content-based-on-user-meta-values)
* Added support for multiple parameters using the `IN` operator with the [`user_meta_if` shortcode](https://wpfusion.com/documentation/getting-started/shortcodes/#displaying-content-based-on-user-meta-values)

* Added View in CRM links to Brevo integration
* Added option to [subscribe ConvertKit subscribers to a form when applying tags](https://wpfusion.com/documentation/crm-specific-docs/convertkit-unsubscribe-notifications/https://wpfusion.com/documentation/crm-specific-docs/convertkit-unsubscribe-notifications/#re-subscribing-unsubscribed-subscribers)
* Added HTTP API logging for applying and removing tags with Drip
* Added support for [multi-value lookup fields with Dynamics 365](https://wpfusion.com/documentation/crm-specific-docs/dynamics-365-associating-entities/#multi-value-lookup-fields)
* Added option with Dynamics 365 to sync with Leads or Cases instead of Contacts
* Added "View in CRM" links to HighLevel
* Added "Resubscribe" option with MailerLite‚Äî if enabled, and a contact is unsubscribed, they will be resubscribed when they are added to a new group
* Added support for automatically embedding [the MailerLite tracking script](https://wpfusion.com/documentation/tutorials/site-tracking-scripts/#mailerlite)
* Added support for setting the `bulk_mail` and `bulk_sms` fields to Transactional Only with Ontraport
* Added an object type dropdown for Salesforce
* Added option to [use a multi-select for segmentation with Zoho](https://wpfusion.com/documentation/crm-specific-docs/zoho-tags/) (instead of tags)


##### Improvements

* Improved - [Force killing the background worker](https://wpfusion.com/documentation/tutorials/batch-operations/#cancelling) will now also unlock the process lock so a new operation can be started
* Improved - If a post type or category/term is protected and configured with a redirect, any redirect on the underlying post will now take priority
* Improved support for detecting email address changes from non-supported plugins (i.e. JetEngine Forms)
* Improved - CRMs that use OAuth will now have the refresh token and access token fields disabled in the settings to prevent browsers from accidentally filling the fields
* Improved - Exported logs will now include the error level string instead of numeric ID
* Improved - When updating a user profile in the admin, the log source will say `user-profile` instead of `unknown`
* Improved styling of the WP Fusion metabox when using the Gutenberg editor
* Improved "Redirect if access is denied" dropdown in admin - Will now only search for pages by title, not content, and will validate external URLs
* Improved - The View in CRM links in the logs and elsewhere now work when using custom object types (with CRMs that support custom object types)

* Improved - Shortened ActiveCampaign API timeout to 10 seconds instead of 20
* Improved - With WordPress 6.3+ the [Bento tracking script](https://wpfusion.com/documentation/tutorials/site-tracking-scripts/#bento) will now be loaded `async` by default
* Improved - The Bento tracking script will now wait for the `bento:ready` event
* Updated Sendinblue integration to Brevo
* Improved performance for applying and removing lists with Brevo (aka Sendinblue)
* Improved - Brevo integration will now use numeric contact IDs instead of email addresses as unique identifiers (backwards compatible with users who are still linked via email)
* Improved error handling for failed access token refreshes with Constant Contact
* Improved - With Dynamics 365, dynamic marketing lists will now show as Read Only in the WP Fusion UI, and won't be selectable for "Assign Lists"
* Improved - The GetResponse integration can now trigger autoresponders when a contact is added to a list
* Improved - The GetResponse integration can now remove tags
* Updated HighLevel integration to use the 2.0 API (allows us to add Enhanced Ecommerce and UTM tracking)
* Improved HighLevel error reporting for duplicate contact errors
* Improved HubSpot error handling
* Improved API performance while applying groups with MailerLite
* Improved Maropost error handling
* Improved - Updated [Sendlane integration](https://wpfusion.com/documentation/installation-guides/how-to-connect-sendlane-to-wordpress/) to use the v2 API (requires generating a new access token)
* Improved - Contacts synced to Ontraport with `bulk_sms` set to no will also be synced with `force_sms_opt_out` set to true, to ensure they are opted out of bulk SMS


##### Bug Fixes

* Fixed an infinite redirect if a guest tried to access a piece of protected content and "Refresh tags if access is denied" was enabled on that content
* Fixed "Exclude Administrators" setting not being respected for the site lockout feature
* Fixed View in CRM links in the logs not working correctly with Dynamics 365
* Fixed a fatal error if the WP Fusion settings were reset in the middle of a batch operation
* Fixed background worker not working on sites protected by HTTP Basic Authentication
* Fixed fatal error in the Custom Code section of the main settings page when a static class method had been attached to a `wpf_*` filter
* Fixed Filter Queries - Advanced not working with Search & Filter Pro (changed priority from 10 to 100)
* Fixed a fatal error calling `wp_fusion()->user->push_user_meta()` on an invalid user ID
* Fixed a fatal error trying to access the CRM PHP API before it was loaded

* Fixed event tracking not sending the value (i.e. `details`) to Brevo
* Fixed Constant Contact integration not loading more than 50 tags
* Fixed unhandled error refreshing access token with Constant Contact
* Fixed Constant Contact refresh token expiring after two refreshes
* Fixed empty dates syncing to ConvertKit as 1/1/1970
* Fixed ConvertKit integration removing times from date + time fields
* Fixed dynamic lists showing as options for import with Dynamics 365
* Fixed import tool not working with Dynamics 365
* Fixed fatal error connecting to EmailOctopus when there were no lists or tags in the account
* Fixed FluentCRM (same site) processing tags modified by automations before tags edited on the subscriber record, causing the WP user's tag cache to lose the tags applied by the automation
* Fixed a fatal error with FluentCRM when a user changed their email address to the email address of an existing (other) subscriber in FluentCRM (same site)
* Fixed typo "susbcribed" in default optin status for FluentCRM (REST API)
* Fixed bug in HighLevel error handling, errors with a `meta` parameter were triggering a fatal error when logged
* Fixed empty dates synced to HighLevel getting converted to 1-1-1970
* Fixed first API call after refreshing a HighLevel access token being treated as an error
* Fixed Klaviyo integration not loading more than ten lists
* Fixed MailerLite (Classic) integration giving an Unauthorized error when applying groups via a batch operation
* Fixed custom fields not loading with Maropost
* Misc Maropost bugfixes
* Fixed import tool not working with Pipedrive
* Fixed read-only fields being synced back to Salesforce and causing API errors
* Fixed Zoho integration linking users with contact records who had a matching email address on Secondary Email or other email fields than the primary Email field


##### Developer

* Added function `wpf_validate_phone_number()`
* Added filter `wpf_dynamics_365_lookup_field`
* Improved - The AJAX endpoint for applying tags can now accept form-encoded or JSON encoded data
* Improved - the WP Fusion section on the admin user profile will now require the `edit_users` capability instead of `manage_options`
* Improved - CRMs with an `init()` method will now run on the `init` action at priority 5, instead of `plugins_loaded`. This makes it easier for custom code added to the theme's `functions.php` to modify CRM parameters such as the API URL or object type
* Improved - Removed redundant check for `wpf_is_user_logged_in()` in the WP Fusion secure block access logic
* Fixed - the `wpf_admin_override` filter did not apply to the core `user_can_access()` function
* Fixed custom args passed to `wp_fusion()->batch->batch_init()` being ignored



= 3.41.2 - 3/27/2023 =

##### Tech stuff

* Tested for WordPress 6.2.0

##### New CRMs

* Added [Ortto CRM integration](https://wpfusion.com/documentation/installation-guides/how-to-connect-ortto-to-wordpress/)
* Added [Engage CRM integration](https://engage.so)


##### New Features

* Added option to [refresh a user's tags when access is denied](https://wpfusion.com/documentation/getting-started/working-with-tags/#when-access-is-denied)
* Added `wpf-refresh` query string parameter [to force a refresh of the user's tags and/or meta from the CRM](https://wpfusion.com/documentation/getting-started/shortcodes/#via-url)
* Added a [`sync_if_empty` parameter](https://wpfusion.com/documentation/getting-started/shortcodes/#sync-if-empty) to the `user_meta` shortcode
* Added option to [completely remove all WP Fusion settings](https://wpfusion.com/documentation/tutorials/switching-crms/#2-reset-wp-fusion) from the database when resetting the main settings page
* Added Previous User Email field for sync (to track email address changes)

* Added support for [updating lookup fields and associated entities with Microsoft Dynamics 365 Marketing](https://wpfusion.com/documentation/crm-specific-docs/dynamics-365-associating-entities/)
* Added option with FluentCRM (REST API and same site) to set the default status for new contacts to either Subscribed or Pending (and trigger a double opt-in email)
* Added link to edit the contact in the CRM for HighLevel (requires a Resync Contact IDs operation to load the edit URLs)
* Added new scopes to HubSpot integration: timeline, crm.objects.custom.read, and crm.objects.custom.write
* Added [Intercom event tracking](https://wpfusion.com/documentation/event-tracking/intercom-event-tracking/)
* Added [Intercom site tracking](https://wpfusion.com/documentation/tutorials/site-tracking-scripts/#intercom)
* Added [Klaviyo event tracking](https://wpfusion.com/documentation/event-tracking/klaviyo-event-tracking/)
* Added direct link to view a subscriber from WordPress when using the new V2 MailerLite API
* Added OAuth API integration with Mautic (requires settings reset)
* Added [Optin Status field for sync with MailerLite](https://wpfusion.com/documentation/crm-specific-docs/mailerlite-double-opt-ins/) ‚Äî you can sync a value of `active`, `unconfirmed`, or `unsubscribed` to update the subscriber's status in MailerLite


##### Improvements

* Improved - With CRMs that support identifying a visitor to a tracking script via JavaScript, a visitor can now be identified in the same page load as a form submission (instead of requiring a redirect or refresh)
* Improved - The "Select a redirect" box in the main WP Fusion metabox can now accept a page or a URL
* Improved - The API Queue will now run on the `shutdown` hook at priority -1 instead of 1, to try and get ahead of any potential redirects in WooCommerce payment gateways
* Improved - You can now set the `WPF_MULTISITE_PREFIX_KEYS` in wp-config.php to turn on [blog ID prefixes for usermeta keys](https://wpfusion.com/documentation/faq/multisite/)
* Improved - When an auto-login session loads the tags for someone who has a user account on the site, those tags will also be saved to their local cache
* Improved - Clicking Cancel on a batch operation / export operation will now cancel the next operation in the queue, even if the key is unknown
* Improved status output for batch operations in the console: will now count items processed in the last batch, and available memory is human-readable
* Improved - Some plugins sloppily trigger `wp_login` twice during a single login. WP Fusion will now only run on the first instance
* Improved notifications when an error was encountered saving or validating an option in the WP Fusion settings
* Improved: the `wpf_update_meta` and `wpf_update_tags` shortcodes will now output an HTML comment to help locating them within a page
* Improved - Using the `date-format` parameter in the `user_meta` shortcode will now output the date in the site's language (as opposed to English)
* Improved - If a user's contact record is deleted, their cached tags will be deleted as well (previously these were left behind and could clutter up the database)
* Improved - If a contact was created in staging mode, deactvating staging mode will also remove the user's `staging_xxxx` contact ID
* Improved lead source tracking ‚Äî tracking data will now be stored JSON-encoded inside of a single cookie, instead of across multiple cookies
* Improved - Set a `max-height` on the debug output for HTTP API logging in the logs
* Improved - With CRMs which require an email address for some API calls, WP Fusion will now check to see if the email can be retrieved from a WooCommerce order before making an API call to load the contact (improves performance)

* Improved - ActiveCampaign event tracking API calls updated to use `wp_remote_post()` instead of `wp_safe_remote_post()` to fix occasional `A valid URL was not provided` errors
* Improved - The Bento tracking script will now be registered via `wp_enqueue_script()` instead of inline, to play better with caching and optimization plugins
* Improved - The cookie to track Bento guest form submissions will only be set for one hour (instead of one year). This is plenty of time for the Bento tracking script to pick it up, and will make it easier to cache pages for identified guests
* Improved - Guest form submissions and checkouts will now pass the guest's email address to the Bento tracking script
* Improved - Removed redundant `name` and `email` custom fields with Bento
* Improved error handling with Dynamics 365
* Improved - Updated Klaviyo integration to use the new v2022-10-17 API, which will greatly improve performance
* Improved MailerLite error handling
* Improved - When changing the tag type with Salesforce, all users will automatically have their tags resynced from the CRM
* Improved - When using a Picklist for Salesforce tags, if an unknown is loaded for a user, it will be added to the dropdown of available options


##### Bug Fixes

* Fixed "Action Failed" error when flushing the logs when WooCommmerce's logging was active in database mode
* Fixed fatal error with Push All when other plugins updated user meta fields before WP Fusion had loaded
* Fixed HTML in custom field names being displayed in the Contact Fields list
* Fixed JavaScript based lead source tracking not working with WP Rocket
* Fixed warning "Attempt to read `cap_key` on bool" when adding or removing roles with a deleted user ID
* Fixed the `wpf_update_meta` shortcode triggering a pull from the CRM multiple times per page load (if used with multiple blank fields)
* Fixed WP Fusion not running on multiple user registrations in the same request
* Fixed `timezone-offset` parameter in the `user_meta` shortcode being treated as minutes, not hours
* Fixed batch operations started on a single multisite showing the status bar on all other sites in the network
* Fixed fatal error displaying a user's tags on the All Users list when a user's tags were stored as a string, with PHP 8
* Fixed PHP error `Cannot use string offset as array` when importing users with PHP 8
* Fixed being unable to clear out the User dropdown filter in the logs once a user was selected

* Fixed Event Tracking not working with a recent ActiveCampaign API update (not sure exactly when it started)
* Fixed the ActiveCampaign integration intercepting API errors from other CRMs during the initial connection process
* Fixed fatal error syncing string-formatted date timestamps to ActiveCampaign with PHP 8.1
* Fixed link to edit subscriber in Bento not available immediately after creating a new subscriber
* Fixed Bento integration returning `false` when a contact had no tags, instead of an empty array. Sometimes caused errors with other integrations.
* Fixed: Removed Drip site tracking code (Drip no longer supports site tracking)
* Fixed date fields not syncing to FluentCRM (REST API)
* Fixed API errors syncing multiselect or array data with Gist
* Fixed Event Tracking not working with Groundhogg (This Site)
* Fixed custom properties created with the core Groundhogg plugin (not the Better Meta extension) not being available for sync
* Fixed error resyncing available fields when the Groundhogg Better Meta plugin was active
* Fixed logs warning with Groundhogg when a user updated their email address to have capital letters in it
* Fixed Event Tracking updating the most recent event instead of creating a new one with Groundhogg (REST API)
* Fixed Groundhogg (REST API) integration not loading more than 100 available tags
* Fixed all phone numbers getting synced to HighLevel with a +1 country code
* Fixed HubSpot integration using a 120 second timeout
* Fixed redirect URI mismatch error with HubSpot (since HubSpot scopes were updated on March 24th)
* Fixed GMT calculation with HubSpot dates adding the GMT offset when it should have been subtracing it
* Fixed error `Failed to parse XML-RPC request` when syncing HTML in text fields to Infusionsoft / Keap
* Fixed warnings `Return type of X should be compatible with Y` warnings with PHP 8.1 and the XMLRPC library (Infusionsoft/Keap)
* Fixed Klaviyo integration sometimes loading "Unknown List" entries from subscribers in cases of deleted or system lists
* Fixed groups not applying for anonymous subscribers when using the new MailerLite API
* Fixed updating a user profile in WordPress marking MailerLite subscribers as Active even if they hadn't been confirmed yet
* Fixed MailPoet integration listing a user's segments as "unknown lists"
* Fixed an unhandled error refreshing the Mautic access token when the user's API credentials had changed
* Fixed - Pipedrive integration will now use a private app instead of a public app, which will allow setup to complete (previously we were pending a public app review for several months)
* Fixed Quentn integration treating a Contact Not Found as a serious error
* Fixed import tool not working with Salesforce picklist-based segmentation
* Fixed Salesforce integration not loading more than 2000 available topics
* Fixed Import Users tool with Sendinblue not loading more than 500 subscribers
* Fixed PHP warning `Undefined variable $code` in Zoho integration when handling an API error


##### Developer
* Developers: If the background worker / exporter goes rogue, [you can now hard cancel everything](https://wpfusion.com/documentation/tutorials/batch-operations/#cancelling) by appending `&wpf-cancel-batch` to the WPF settings page URL
* Developers: Added filter `wpf_get_email_from_contact_id`
* [Updated Growmatik integration](https://github.com/verygoodplugins/wp-fusion-lite/pull/20)

For previous release notes see the [changelog](https://wpfusion.com/documentation/faq/changelog/?utm_campaign=free-plugin&utm_source=wp-org).